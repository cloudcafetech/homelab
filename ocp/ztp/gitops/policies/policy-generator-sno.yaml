apiVersion: policy.open-cluster-management.io/v1
kind: PolicyGenerator
metadata:
  name: policies-sno-clusters
placementBindingDefaults:
  name: "placementbinding"

policyDefaults:
  namespace: ztp-common
  placement:
    labelSelector:
      siteName: "store"
      
policies:
  - name: oauth-configuration
    description: "Configure HTTPaswd authentication and associated roles"
    manifests:
      - path: ../policies/global/security-auth/htpasswd.yaml
    remediationAction: enforce
    categories:
      - "SC System and Communications Protection"
    controls:
      - "SC-1 SYSTEM AND COMMUNICATIONS PROTECTION POLICY AND PROCEDURES"
    standards:
      - "NIST SP 800-53"
    severity: high

  - name: install-cert-manager
    description: "Install and configure Cert Manager for certificate management"
    manifests:
      - path: ../policies/global/operators/certmanager-operator.yaml
    remediationAction: enforce
    categories:
      - "CM Configuration Management"
    controls:
      - "CM-2 Baseline Configuration"
    standards:
      - "NIST SP 800-53"
    severity: low

  - name: install-metallb-operator
    description: "Install MetalLB Operator for Loadbalancer"
    manifests:
      - path: ../policies/global/operators/metallb-operator.yaml
    remediationAction: enforce
    categories:
      - "CM Configuration Management"
    controls:
      - "CM-2 Baseline Configuration"
    standards:
      - "NIST SP 800-53"
    severity: medium
